# 文件说明

## drawmap

* [绘图入口程序](src/drawmap/main.py)- 包含定时器，数据访问拼接，外部调用绘图功能
* [工具函数](src/drawmap/libs/utils.py)-包括函数readFromTDS, findLogDataByStationId, findLogDataBytimeStep, convertDataArray, nwp_var_config
* [绘图函数](src/drawmap/libs/drawMap.py)-包括tf.model加载，predictFog雾预报模型，draw_Fog_Contour绘制能见度填图

# 建模V1
* [台内项目第一版fog最佳集合](src/tf2/sea_fog_reg_model_all.ipynb) -> ./data/model/model_singletest_fog_dataset_hdf66_fc120h_v2

# 数据预处理


# 构建样本流程

1. [conver2CF](src/conver2CF.py)conver2CF.py: 转换为CF兼容格式和合并多个时段的netcdf, 函数scan_convet_CF检索文件夹中的文件并转换为CF兼容格式, concat_multi_ds合并多个变量名到一个netcdf
2. [fill_hour_netcdf](src/fill_hour_netcdf.py)fill_hour_netcdf.py: 填充为逐小时预报数据,fill_hour()函数用于在已有的NetCDF文件中，通过插值算法扩充数据至逐小时。
3. [merge_csv](src/ipynb/merge_csv.ipynb)merge_csv.ipynb: 合并station数据, 把三个站点的数据合并成一个，取相同时刻能见度的最小值作为琼州海峡的数据
4. [merge.netcdf_multi](src/merge.netcdf_multi.py)merge.netcdf_multi.py: 合并netcdf数据和站点数据到HDF文件中
5. build.dataset.py / fullhour_sample_dataset.ipynb: 从hdf中创建数据集

## 最佳预报说明

#### ===================测试集==========
* 实况为雾时: 比例: 雾:0.6136307699192267, 轻雾0.38200613071398204, 无雾0.00436309936679122
* 实况为轻雾时: 比例: 雾:0.20795202828183385, 轻雾0.7350815563958562, 无雾0.056966415322309984
* 实况为无雾时: 比例: 雾:0.0035352292305282705, 轻雾0.24742129639988364, 无雾0.7490434743695881
* TS评分: 雾: 0.5065102964262628, 轻雾及雾: 0.8612651835947596
#### ==============测试集+验证集==========
* 实况为雾时: 比例: 雾:0.6423672875762152, 轻雾0.3535492532304078, 无雾0.004083459193376965
* 实况为轻雾时: 比例: 雾:0.20794316719807573, 轻雾0.7342954634446496, 无雾0.05776136935727471
* 实况为无雾时: 比例: 雾:0.0035800190188510377, 轻雾0.24838619455165856, 无雾0.7480337864294904
* TS评分: 雾: 0.5302146049569681, 轻雾及雾: 0.8606501997098742
#### ==================训练集==========
* 实况为雾时: 比例: 雾:0.8995288416665068, 轻雾0.10023462022848302, 无雾0.00023653810501013278
* 实况为轻雾时: 比例: 雾:0.0928380097555986, 轻雾0.7345211381957896, 无雾0.17264085204861176
* 实况为无雾时: 比例: 雾:0.005114337405624492, 轻雾0.25525657991471845, 无雾0.7396290826796571
* TS评分: 雾: 0.8192785816180966, 轻雾及雾: 0.8083286667006058
#### ===============验证集==========
* 实况为雾时: 比例: 雾:0.6711044482233957, 轻雾0.3250917390136937, 无雾0.003803812762910588
* 实况为轻雾时: 比例: 雾:0.2079343059160476, 轻雾0.733509352904323, 无雾0.05855634117962946
* 实况为无雾时: 比例: 雾:0.0036248098093618546, 轻雾0.24935111429338583, 无雾0.7470240758972523
* TS评分: 雾: 0.5539180379337729, 轻雾及雾: 0.8600357533022147